<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docker Production Mastery - Complete Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .hero-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px 20px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .sticky-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 10px 15px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .hero-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .hero-title-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .logo-box {
            display: inline-flex;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 12px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .logo-icon {
            font-size: 2rem;
        }

        h1 {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
        }

        .tabs {
            display: flex;
            gap: 6px;
            justify-content: center;
            flex-wrap: nowrap;
            overflow-x: auto;
            margin: 0 auto;
        }

        .tab-btn {
            background: white;
            color: #64748b;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            white-space: nowrap;
            min-width: fit-content;
        }

        .tab-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.15);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.4);
            transform: translateY(-1px);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: fadeIn 0.5s ease-in;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #e2e8f0;
        }

        .info-box {
            border-left: 5px solid #667eea;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }

        .info-box.concept {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
        }

        .info-box.tip {
            background: #ecfdf5;
            border-left-color: #10b981;
        }

        .info-box.warning {
            background: #fef3c7;
            border-left-color: #f59e0b;
        }

        .info-box.danger {
            background: #fee2e2;
            border-left-color: #ef4444;
        }

        .code-block {
            position: relative;
            margin: 20px 0;
        }

        .code-lang {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(102, 126, 234, 0.9);
            color: white;
            padding: 4px 12px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 1;
        }

        pre {
            background: #0f172a;
            color: #e2e8f0;
            padding: 25px;
            border-radius: 12px;
            overflow: auto;
            font-family: "Courier New", monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            margin: 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .key-point {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.08) 0%, rgba(6, 182, 212, 0.08) 100%);
            padding: 20px 25px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 5px solid #0ea5e9;
            font-size: 1.05rem;
            font-weight: 600;
            color: #1e293b;
        }

        .grid {
            display: grid;
            gap: 20px;
            margin: 30px 0;
        }

        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .author-section {
            background: linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%);
            border-radius: 20px;
            padding: 30px 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .author-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .author-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
            letter-spacing: 0.5px;
            text-transform: uppercase;
            opacity: 0.9;
        }

        .author-name {
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 12px;
        }

        .author-desc {
            font-size: 1rem;
            font-weight: 500;
            margin-bottom: 8px;
            line-height: 1.5;
            color: rgba(255, 255, 255, 0.95);
        }

        .social-links {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 18px;
        }

        .social-btn {
            color: white;
            padding: 10px 25px;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .social-btn.linkedin {
            background: #0077b5;
            box-shadow: 0 4px 15px rgba(0, 119, 181, 0.3);
        }

        .social-btn.github {
            background: #181717;
            box-shadow: 0 4px 15px rgba(24, 23, 23, 0.3);
        }

        .social-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .footer {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 30px;
            text-align: center;
            color: white;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .hidden {
            display: none;
        }

        h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin: 30px 0 15px 0;
        }

        h4 {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1e293b;
            margin: 20px 0 10px 0;
        }

        p, li {
            line-height: 1.8;
            color: #334155;
            margin: 10px 0;
        }

        ul, ol {
            margin-left: 25px;
        }

        strong {
            color: #667eea;
            font-weight: 700;
        }

        @media (max-width: 768px) {
            .grid-3 {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.5rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .author-title {
                font-size: 2rem;
            }

            .author-name {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Hero Title Section (Non-Sticky) -->
    <div class="hero-section">
        <div class="hero-content">
            <div class="hero-title-section">
                <div class="logo-box">
                    <span class="logo-icon">üê≥</span>
                </div>
                <h1>Docker Production Mastery</h1>
            </div>
        </div>
    </div>

    <!-- Sticky Tab Navigation -->
    <div class="sticky-header">
        <div class="hero-content">
            <div class="tabs">
                <button class="tab-btn active" onclick="showSection('entrypoint')">‚öôÔ∏è ENTRYPOINT vs CMD</button>
                <button class="tab-btn" onclick="showSection('multistage')">üèóÔ∏è Multi-Stage</button>
                <button class="tab-btn" onclick="showSection('security')">üîê Security</button>
                <button class="tab-btn" onclick="showSection('root')">üë§ Root vs Non-Root</button>
                <button class="tab-btn" onclick="showSection('proxy')">üîÑ Nginx Proxy</button>
                <button class="tab-btn" onclick="showSection('production')">üöÄ Production</button>
                <button class="tab-btn" onclick="showSection('complete')">üìö Complete Notes</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- ENTRYPOINT vs CMD Section -->
        <div id="entrypoint" class="section">
            <div class="glass-card">
                <h2 class="section-title">‚öôÔ∏è ENTRYPOINT vs CMD</h2>

                <div class="info-box concept">
                    <h3>Core Concept</h3>
                    <p><strong>ENTRYPOINT:</strong> Defines the main executable (fixed)</p>
                    <p><strong>CMD:</strong> Provides default arguments (overridable)</p>
                </div>

                <div class="key-point">
                    <strong>‚≠ê Golden Rule:</strong> ENTRYPOINT = main command | CMD = default parameters
                </div>

                <h3>Basic Example</h3>
                <div class="code-block">
                    <div class="code-lang">Dockerfile</div>
                    <pre><code>FROM ubuntu:22.04
RUN apt-get update && apt-get install -y curl

ENTRYPOINT ["curl"]
CMD ["https://example.com"]</code></pre>
                </div>

                <div class="code-block">
                    <div class="code-lang">bash</div>
                    <pre><code># Normal run
docker run myimage
‚Üí Executes: curl https://example.com

# Override CMD
docker run myimage https://google.com
‚Üí Executes: curl https://google.com</code></pre>
                </div>

                <h3>Why Both Together?</h3>
                <ul>
                    <li><strong>Flexibility:</strong> Different environments can use different args</li>
                    <li><strong>K8s/Compose:</strong> Override CMD via YAML configuration</li>
                    <li><strong>No Rebuild:</strong> Config changes without rebuilding image</li>
                </ul>

                <div class="info-box tip">
                    <strong>‚úÖ Best Practice:</strong> Always use exec form (JSON array)
                    <div class="code-block">
                        <div class="code-lang">Dockerfile</div>
                        <pre><code># ‚úÖ Correct (Exec form)
ENTRYPOINT ["nginx"]
CMD ["-g", "daemon off;"]

# ‚ùå Avoid (Shell form)
ENTRYPOINT nginx -g "daemon off;"</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Multi-Stage Section -->
        <div id="multistage" class="section hidden">
            <div class="glass-card">
                <h2 class="section-title">üèóÔ∏è Multi-Stage Docker Builds</h2>

                <div class="info-box concept">
                    <h3>What is Multi-Stage Build?</h3>
                    <p>Build your application in one stage, run it in another. Only copy what you need for production.</p>
                </div>

                <div class="key-point">
                    <strong>üéØ Result:</strong> Smaller images (~25MB vs ~800MB) + Better security + No build tools in production
                </div>

                <div class="code-block">
                    <div class="code-lang">Dockerfile</div>
                    <pre><code># ========================================
# STAGE 1: BUILD
# ========================================
FROM node:20-alpine AS build

WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

# ========================================
# STAGE 2: RUNTIME
# ========================================
FROM nginx:1.25-alpine

RUN rm /etc/nginx/conf.d/default.conf
COPY nginx.conf /etc/nginx/conf.d/default.conf
COPY --from=build /app/dist/public /usr/share/nginx/html

EXPOSE 80
ENTRYPOINT ["nginx"]
CMD ["-g", "daemon off;"]</code></pre>
                </div>

                <h3>Image Size Comparison</h3>
                <div class="grid grid-3">
                    <div class="stat-card" style="border: 3px solid #ef4444;">
                        <div style="font-size: 2rem; font-weight: 800; color: #ef4444; margin-bottom: 8px;">~800MB</div>
                        <div style="font-size: 0.9rem; color: #64748b; font-weight: 600;">Single Stage</div>
                    </div>
                    <div class="stat-card" style="border: 3px solid #f59e0b;">
                        <div style="font-size: 2rem; font-weight: 800; color: #f59e0b; margin-bottom: 8px;">‚Üí</div>
                        <div style="font-size: 0.9rem; color: #64748b; font-weight: 600;">Optimize</div>
                    </div>
                    <div class="stat-card" style="border: 3px solid #10b981;">
                        <div style="font-size: 2rem; font-weight: 800; color: #10b981; margin-bottom: 8px;">~25MB</div>
                        <div style="font-size: 0.9rem; color: #64748b; font-weight: 600;">Multi Stage</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Security Section -->
        <div id="security" class="section hidden">
            <div class="glass-card">
                <h2 class="section-title">üîê Security Best Practices</h2>

                <div class="info-box concept">
                    <h3>Three Pillars of Docker Security</h3>
                    <ol>
                        <li><strong>Minimal Image:</strong> Only include what's necessary</li>
                        <li><strong>Non-Root User:</strong> Run with least privileges</li>
                        <li><strong>No Secrets:</strong> Inject at runtime only</li>
                    </ol>
                </div>

                <div class="info-box danger">
                    <strong>‚ö†Ô∏è Critical:</strong> Without .dockerignore, secrets WILL leak into your image!
                </div>

                <h3>Essential .dockerignore</h3>
                <div class="code-block">
                    <div class="code-lang">.dockerignore</div>
                    <pre><code>node_modules
.git
.env
.env.local
*.log
Dockerfile
docker-compose.yml</code></pre>
                </div>

                <div class="grid grid-2">
                    <div>
                        <h4 style="color: #ef4444;">‚ùå Wrong</h4>
                        <div class="code-block">
                            <div class="code-lang">Dockerfile</div>
                            <pre><code>ENV DB_PASSWORD=secret123
# Baked into image!</code></pre>
                        </div>
                    </div>
                    <div>
                        <h4 style="color: #10b981;">‚úÖ Correct</h4>
                        <div class="code-block">
                            <div class="code-lang">bash</div>
                            <pre><code>docker run -e DB_PASSWORD=secret123
# Injected at runtime</code></pre>
                        </div>
                    </div>
                </div>

                <div class="key-point">
                    <strong>üéØ Golden Rule:</strong> Image = blueprint | Secrets = keys (attached at runtime)
                </div>
            </div>
        </div>

        <!-- Root vs Non-Root Section -->
        <div id="root" class="section hidden">
            <div class="glass-card">
                <h2 class="section-title">üë§ Root vs Non-Root Users</h2>

                <div class="info-box concept">
                    <h3>Understanding Root</h3>
                    <p><strong>Root:</strong> Superuser with unlimited permissions (dangerous!)</p>
                    <p><strong>Non-root:</strong> Limited user with restricted access (safe!)</p>
                </div>

                <div class="info-box danger">
                    <strong>‚ö†Ô∏è Security Risk:</strong> If attacker exploits your app running as root, they have FULL system access
                </div>

                <div class="info-box warning">
                    <strong>üîî Nginx Special Case:</strong> Nginx needs root to bind port 80, but workers run as non-root
                </div>

                <div class="code-block">
                    <div class="code-lang">bash</div>
                    <pre><code>docker exec -it frontend ps aux

# Output:
USER     PID  COMMAND
root       1  nginx: master process  ‚Üê Binds port 80 only
nginx      7  nginx: worker process  ‚Üê Handles ALL traffic
nginx      8  nginx: worker process  ‚Üê Handles ALL traffic</code></pre>
                </div>

                <div class="key-point">
                    <strong>üéØ Key Takeaway:</strong> Root only opens the gate, non-root does ALL the work
                </div>

                <h3>Strict Non-Root Setup (Port 8080)</h3>
                <div class="code-block">
                    <div class="code-lang">Dockerfile</div>
                    <pre><code>FROM nginx:alpine

RUN addgroup -S app && adduser -S app -G app
RUN sed -i 's/listen 80;/listen 8080;/' /etc/nginx/conf.d/default.conf
RUN chown -R app:app /var/cache/nginx /var/run /usr/share/nginx/html

USER app
EXPOSE 8080</code></pre>
                </div>
            </div>
        </div>

        <!-- Nginx Proxy Section -->
        <div id="proxy" class="section hidden">
            <div class="glass-card">
                <h2 class="section-title">üîÑ Nginx Reverse Proxy</h2>

                <div class="info-box concept">
                    <h3>What is Reverse Proxy?</h3>
                    <p>Nginx sits between browser and backend, forwarding requests transparently</p>
                </div>

                <div class="key-point">
                    <strong>üéØ Why?</strong> Browser only knows ONE address. Nginx decides: frontend files or backend API?
                </div>

                <h3>nginx.conf Configuration</h3>
                <div class="code-block">
                    <div class="code-lang">nginx</div>
                    <pre><code>upstream backend_api {
    server YOUR_BACKEND_IP:8000;
}

server {
    listen 80;
    root /usr/share/nginx/html;

    # Frontend routes
    location / {
        try_files $uri $uri/ /index.html;
    }

    # API proxy - THE MAGIC ‚ú®
    location /api/ {
        proxy_pass http://backend_api;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}</code></pre>
                </div>

                <div class="info-box tip">
                    <strong>‚úÖ Benefits:</strong>
                    <ul>
                        <li>No CORS issues</li>
                        <li>Backend IP hidden from public</li>
                        <li>SSL termination at one point</li>
                        <li>Load balancing capabilities</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Production Section -->
        <div id="production" class="section hidden">
            <div class="glass-card">
                <h2 class="section-title">üöÄ Production-Ready Dockerfile</h2>

                <div class="info-box concept">
                    <h3>Gold Standard Template</h3>
                    <p>Combines: Multi-stage + Security + Nginx proxy + Proper user management</p>
                </div>

                <div class="code-block">
                    <div class="code-lang">Dockerfile</div>
                    <pre><code># ============================================
# STAGE 1: BUILD
# ============================================
FROM node:20-alpine AS build

WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

# ============================================
# STAGE 2: RUNTIME
# ============================================
FROM nginx:1.25-alpine

RUN rm /etc/nginx/conf.d/default.conf
COPY nginx.conf /etc/nginx/conf.d/default.conf
COPY --from=build /app/dist/public /usr/share/nginx/html

EXPOSE 80
ENTRYPOINT ["nginx"]
CMD ["-g", "daemon off;"]</code></pre>
                </div>

                <h3>Build & Deploy</h3>
                <div class="code-block">
                    <div class="code-lang">bash</div>
                    <pre><code># Build image
docker build -t frontend-app:v1.0 .

# Run container
docker run -d -p 80:80 --restart always frontend-app:v1.0

# Test
curl http://localhost
curl http://localhost/api/health</code></pre>
                </div>

                <h3>Production Checklist</h3>
                <ul>
                    <li>‚úÖ Multi-stage build</li>
                    <li>‚úÖ .dockerignore present</li>
                    <li>‚úÖ ENTRYPOINT + CMD</li>
                    <li>‚úÖ Non-root workers</li>
                    <li>‚úÖ Reverse proxy config</li>
                    <li>‚úÖ Health endpoint</li>
                </ul>
            </div>
        </div>

        <!-- Complete Notes Section -->
        <div id="complete" class="section hidden">
            <div class="glass-card">
                <div style="text-align: center; margin-bottom: 40px;">
                    <div style="font-size: 4rem; margin-bottom: 20px;">üìö</div>
                    <h2 class="section-title" style="border-bottom: none;">Complete Docker Production Guide</h2>
                    <p style="font-size: 1.2rem; color: #64748b; font-weight: 500;">
                        A to Z - Everything You Need to Know
                    </p>
                </div>
            </div>

            <!-- ENTRYPOINT vs CMD - FULL SECTION -->
            <div class="glass-card">
                <h2 class="section-title">‚öôÔ∏è ENTRYPOINT vs CMD</h2>

                <div class="info-box concept">
                    <h3>Core Concept</h3>
                    <p><strong>ENTRYPOINT:</strong> Defines the main executable (fixed)</p>
                    <p><strong>CMD:</strong> Provides default arguments (overridable)</p>
                </div>

                <div class="key-point">
                    <strong>‚≠ê Golden Rule:</strong> ENTRYPOINT = main command | CMD = default parameters
                </div>

                <h3>Basic Example</h3>
                <div class="code-block">
                    <div class="code-lang">Dockerfile</div>
                    <pre><code>FROM ubuntu:22.04
RUN apt-get update && apt-get install -y curl

ENTRYPOINT ["curl"]
CMD ["https://example.com"]</code></pre>
                </div>

                <div class="code-block">
                    <div class="code-lang">bash</div>
                    <pre><code># Normal run
docker run myimage
# Executes: curl https://example.com

# Override CMD
docker run myimage https://google.com
# Executes: curl https://google.com</code></pre>
                </div>

                <h3>Why Both Together?</h3>
                <ul>
                    <li><strong>Flexibility:</strong> Different environments (dev/prod) can use different args</li>
                    <li><strong>Kubernetes/Compose:</strong> Can override CMD via YAML</li>
                    <li><strong>No Rebuild:</strong> Configuration changes without rebuilding image</li>
                </ul>

                <div class="info-box tip">
                    <strong>‚úÖ Best Practice:</strong> Always use exec form (JSON array)
                    <div class="code-block">
                        <div class="code-lang">Dockerfile</div>
                        <pre><code># ‚úÖ Correct (Exec form)
ENTRYPOINT ["nginx"]
CMD ["-g", "daemon off;"]

# ‚ùå Avoid (Shell form)
ENTRYPOINT nginx -g "daemon off;"</code></pre>
                    </div>
                </div>
            </div>

            <!-- Multi-Stage Builds - FULL SECTION -->
            <div class="glass-card">
                <h2 class="section-title">üèóÔ∏è Multi-Stage Docker Builds</h2>

                <div class="info-box concept">
                    <h3>What is Multi-Stage Build?</h3>
                    <p>Build your application in one stage, run it in another. Only copy what you need for production.</p>
                </div>

                <div class="key-point">
                    <strong>üéØ Result:</strong> Smaller images (~25MB vs ~800MB), better security, no build tools in production
                </div>

                <h3>Complete Example</h3>
                <div class="code-block">
                    <div class="code-lang">Dockerfile</div>
                    <pre><code># ========================================
# STAGE 1: BUILD
# ========================================
FROM node:20-alpine AS build

WORKDIR /app

# Copy deps first (caching optimization)
COPY package*.json ./
RUN npm ci

COPY . .
RUN npm run build

# ========================================
# STAGE 2: RUNTIME
# ========================================
FROM nginx:1.25-alpine

RUN rm /etc/nginx/conf.d/default.conf
COPY nginx.conf /etc/nginx/conf.d/default.conf

# Copy ONLY build output
COPY --from=build /app/dist/public /usr/share/nginx/html

EXPOSE 80
ENTRYPOINT ["nginx"]
CMD ["-g", "daemon off;"]</code></pre>
                </div>

                <h3>Image Size Comparison</h3>
                <div class="grid grid-3">
                    <div class="stat-card" style="border: 3px solid #ef4444;">
                        <div style="font-size: 2rem; font-weight: 800; color: #ef4444; margin-bottom: 8px;">~800MB</div>
                        <div style="font-size: 0.9rem; color: #64748b; font-weight: 600;">Single Stage</div>
                    </div>
                    <div class="stat-card" style="border: 3px solid #f59e0b;">
                        <div style="font-size: 2rem; font-weight: 800; color: #f59e0b; margin-bottom: 8px;">‚Üí</div>
                        <div style="font-size: 0.9rem; color: #64748b; font-weight: 600;">Optimize</div>
                    </div>
                    <div class="stat-card" style="border: 3px solid #10b981;">
                        <div style="font-size: 2rem; font-weight: 800; color: #10b981; margin-bottom: 8px;">~25MB</div>
                        <div style="font-size: 0.9rem; color: #64748b; font-weight: 600;">Multi Stage</div>
                    </div>
                </div>

                <h3>Benefits</h3>
                <ul>
                    <li><strong>Smaller Images:</strong> 97% reduction in size</li>
                    <li><strong>Better Security:</strong> No build tools in production</li>
                    <li><strong>Faster Deployments:</strong> Less data to transfer</li>
                    <li><strong>Cleaner Images:</strong> Only runtime dependencies</li>
                </ul>
            </div>

            <!-- Security - FULL SECTION -->
            <div class="glass-card">
                <h2 class="section-title">üîê Security Best Practices</h2>

                <div class="info-box concept">
                    <h3>Three Pillars of Docker Security</h3>
                    <ol>
                        <li><strong>Minimal Image:</strong> Only include what's necessary</li>
                        <li><strong>Non-Root User:</strong> Run with least privileges</li>
                        <li><strong>No Secrets in Image:</strong> Inject at runtime</li>
                    </ol>
                </div>

                <h3>1. Use .dockerignore</h3>
                <div class="info-box danger">
                    <strong>‚ö†Ô∏è Critical:</strong> Without .dockerignore, secrets WILL leak into your image!
                </div>

                <div class="code-block">
                    <div class="code-lang">.dockerignore</div>
                    <pre><code>node_modules
.git
.env
.env.local
*.log
Dockerfile
docker-compose.yml</code></pre>
                </div>

                <h3>2. Never Hardcode Secrets</h3>
                <div class="grid grid-2">
                    <div>
                        <h4 style="color: #ef4444;">‚ùå Wrong</h4>
                        <div class="code-block">
                            <div class="code-lang">Dockerfile</div>
                            <pre><code>ENV DB_PASSWORD=secret123</code></pre>
                        </div>
                        <p style="font-size: 0.9rem; color: #64748b;">Baked into image</p>
                    </div>
                    <div>
                        <h4 style="color: #10b981;">‚úÖ Correct</h4>
                        <div class="code-block">
                            <div class="code-lang">bash</div>
                            <pre><code>docker run -e DB_PASSWORD=secret123</code></pre>
                        </div>
                        <p style="font-size: 0.9rem; color: #64748b;">Injected at runtime</p>
                    </div>
                </div>

                <div class="key-point">
                    <strong>üéØ Golden Rule:</strong> Image = blueprint | Secrets = keys (attached at runtime)
                </div>

                <h3>3. Use Minimal Base Images</h3>
                <ul>
                    <li><strong>Alpine Linux:</strong> ~5MB base image</li>
                    <li><strong>Distroless:</strong> No shell, package manager</li>
                    <li><strong>Scratch:</strong> Empty image for static binaries</li>
                </ul>

                <h3>4. Scan for Vulnerabilities</h3>
                <div class="code-block">
                    <div class="code-lang">bash</div>
                    <pre><code># Using Docker Scout
docker scout cves myimage:latest

# Using Trivy
trivy image myimage:latest</code></pre>
                </div>
            </div>

            <!-- Root vs Non-Root - FULL SECTION -->
            <div class="glass-card">
                <h2 class="section-title">üë§ Root vs Non-Root Users</h2>

                <div class="info-box concept">
                    <h3>Understanding Root</h3>
                    <p><strong>Root:</strong> Superuser with unlimited permissions</p>
                    <p><strong>Non-root:</strong> Limited user with restricted access</p>
                </div>

                <div class="info-box danger">
                    <strong>‚ö†Ô∏è Security Risk:</strong> If attacker exploits your app running as root, they have full system access
                </div>

                <h3>Nginx Special Case</h3>
                <div class="info-box warning">
                    <strong>üîî Important:</strong> Nginx needs root to bind port 80, but workers run as non-root
                </div>

                <div class="code-block">
                    <div class="code-lang">bash</div>
                    <pre><code>docker exec -it frontend ps aux

# Output:
# USER     PID  COMMAND
# root       1  nginx: master process  ‚Üê Binds port 80
# nginx      7  nginx: worker process  ‚Üê Handles traffic
# nginx      8  nginx: worker process  ‚Üê Handles traffic</code></pre>
                </div>

                <div class="key-point">
                    <strong>üéØ Key Takeaway:</strong> Root only opens the gate, non-root does all the work
                </div>

                <h3>Understanding the Process Model</h3>
                <ul>
                    <li><strong>Master Process (root):</strong> Binds to privileged port 80, reads config, spawns workers</li>
                    <li><strong>Worker Processes (nginx):</strong> Handle ALL incoming HTTP requests</li>
                    <li><strong>Security:</strong> 99.99% of traffic handled by non-root processes</li>
                </ul>

                <h3>Strict Non-Root Setup (Port 8080)</h3>
                <div class="code-block">
                    <div class="code-lang">Dockerfile</div>
                    <pre><code>FROM nginx:alpine

RUN addgroup -S app && adduser -S app -G app
RUN sed -i 's/listen 80;/listen 8080;/' /etc/nginx/conf.d/default.conf
RUN chown -R app:app /var/cache/nginx /var/run /usr/share/nginx/html

USER app
EXPOSE 8080</code></pre>
                </div>

                <div class="info-box tip">
                    <strong>‚úÖ Best Practice:</strong> Use port 8080+ for strict non-root setup. Ports below 1024 require root.
                </div>
            </div>

            <!-- Nginx Reverse Proxy - FULL SECTION -->
            <div class="glass-card">
                <h2 class="section-title">üîÑ Nginx Reverse Proxy</h2>

                <div class="info-box concept">
                    <h3>What is Reverse Proxy?</h3>
                    <p>Nginx sits between the browser and backend servers, forwarding requests transparently to the appropriate backend service.</p>
                </div>

                <div class="key-point">
                    <strong>üéØ Why?</strong> Browser only knows ONE address. Nginx decides: frontend files or backend API?
                </div>

                <h3>How It Works</h3>
                <p style="text-align: center; font-size: 1.1rem; margin: 30px 0;">
                    <strong>üåê Browser</strong> ‚Üí <strong>üîÑ Nginx (Port 80)</strong> ‚Üí <strong>‚ö° Backend API (Port 8000)</strong>
                </p>

                <h3>nginx.conf Configuration</h3>
                <div class="code-block">
                    <div class="code-lang">nginx</div>
                    <pre><code>upstream backend_api {
    server 74.234.94.110:8000;
}

server {
    listen 80;
    root /usr/share/nginx/html;

    # Frontend routes
    location / {
        try_files $uri $uri/ /index.html;
    }

    # API proxy - THE MAGIC
    location /api/ {
        proxy_pass http://backend_api;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}</code></pre>
                </div>

                <h3>Request Flow Example</h3>
                <ol style="font-size: 1rem; line-height: 1.8;">
                    <li><strong>Browser requests:</strong> <code>http://myapp.com/api/users</code></li>
                    <li><strong>Nginx receives:</strong> Request on port 80</li>
                    <li><strong>Nginx checks:</strong> Path starts with <code>/api/</code></li>
                    <li><strong>Nginx forwards:</strong> To backend server at <code>74.234.94.110:8000</code></li>
                    <li><strong>Backend responds:</strong> Data sent back through Nginx</li>
                    <li><strong>Browser receives:</strong> Response (thinks it came from same origin)</li>
                </ol>

                <h3>Benefits</h3>
                <div class="info-box tip">
                    <strong>‚úÖ Key Advantages:</strong>
                    <ul>
                        <li><strong>No CORS Issues:</strong> Browser sees single origin</li>
                        <li><strong>Backend Hidden:</strong> Real backend IP not exposed</li>
                        <li><strong>SSL Termination:</strong> Handle HTTPS at one point</li>
                        <li><strong>Load Balancing:</strong> Distribute traffic across multiple backends</li>
                        <li><strong>Caching:</strong> Cache API responses at Nginx level</li>
                        <li><strong>Rate Limiting:</strong> Protect backend from overload</li>
                    </ul>
                </div>

                <h3>Multiple Backend Services</h3>
                <div class="code-block">
                    <div class="code-lang">nginx</div>
                    <pre><code>upstream api_backend {
    server backend1.local:8000;
}

upstream auth_backend {
    server backend2.local:9000;
}

server {
    listen 80;

    location /api/ {
        proxy_pass http://api_backend;
    }

    location /auth/ {
        proxy_pass http://auth_backend;
    }
}</code></pre>
                </div>
            </div>

            <!-- Production Dockerfile - FULL SECTION -->
            <div class="glass-card">
                <h2 class="section-title">üöÄ Production-Ready Dockerfile</h2>

                <div class="info-box concept">
                    <h3>Gold Standard</h3>
                    <p>Combines: multi-stage + security + nginx proxy + proper user management</p>
                </div>

                <div class="code-block">
                    <div class="code-lang">Dockerfile</div>
                    <pre><code># ============================================
# STAGE 1: BUILD
# ============================================
FROM node:20-alpine AS build

WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

# ============================================
# STAGE 2: RUNTIME
# ============================================
FROM nginx:1.25-alpine

RUN rm /etc/nginx/conf.d/default.conf
COPY nginx.conf /etc/nginx/conf.d/default.conf
COPY --from=build /app/dist/public /usr/share/nginx/html

EXPOSE 80
ENTRYPOINT ["nginx"]
CMD ["-g", "daemon off;"]</code></pre>
                </div>

                <h3>Required Files</h3>
                <div class="code-block">
                    <div class="code-lang">tree</div>
                    <pre><code>project-root/
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ nginx.conf
‚îú‚îÄ‚îÄ .dockerignore
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ src/</code></pre>
                </div>

                <h3>Build & Run Commands</h3>
                <div class="code-block">
                    <div class="code-lang">bash</div>
                    <pre><code># Build image
docker build -t frontend-app:v1.0 .

# Run container
docker run -d -p 80:80 --restart always frontend-app:v1.0

# Test endpoints
curl http://localhost
curl http://localhost/api/health

# View logs
docker logs frontend-app

# Stop container
docker stop frontend-app</code></pre>
                </div>

                <h3>Production Deployment Checklist</h3>
                <ul style="list-style: none; padding: 0;">
                    <li style="padding: 10px; margin: 5px 0; background: #ecfdf5; border-left: 4px solid #10b981; border-radius: 8px;">
                        ‚úÖ <strong>Multi-stage build</strong> (~25MB final image)
                    </li>
                    <li style="padding: 10px; margin: 5px 0; background: #ecfdf5; border-left: 4px solid #10b981; border-radius: 8px;">
                        ‚úÖ <strong>.dockerignore present</strong> (no secrets leaked)
                    </li>
                    <li style="padding: 10px; margin: 5px 0; background: #ecfdf5; border-left: 4px solid #10b981; border-radius: 8px;">
                        ‚úÖ <strong>ENTRYPOINT + CMD</strong> (flexible configuration)
                    </li>
                    <li style="padding: 10px; margin: 5px 0; background: #ecfdf5; border-left: 4px solid #10b981; border-radius: 8px;">
                        ‚úÖ <strong>Non-root workers</strong> (nginx user handles traffic)
                    </li>
                    <li style="padding: 10px; margin: 5px 0; background: #ecfdf5; border-left: 4px solid #10b981; border-radius: 8px;">
                        ‚úÖ <strong>Reverse proxy configured</strong> (API routing setup)
                    </li>
                    <li style="padding: 10px; margin: 5px 0; background: #ecfdf5; border-left: 4px solid #10b981; border-radius: 8px;">
                        ‚úÖ <strong>No secrets in image</strong> (runtime injection)
                    </li>
                </ul>

                <h3>Environment-Specific Configs</h3>
                <div class="code-block">
                    <div class="code-lang">bash</div>
                    <pre><code># Development
docker run -p 3000:80 -e ENV=dev myapp:v1.0

# Staging
docker run -p 80:80 -e ENV=staging myapp:v1.0

# Production
docker run -d -p 80:80 \
  -e ENV=production \
  -e API_URL=https://api.prod.com \
  --restart always \
  myapp:v1.0</code></pre>
                </div>
            </div>

            <!-- Interview Ready - FULL SECTION -->
            <div class="glass-card">
                <h2 class="section-title">üíº Interview-Ready Answers</h2>

                <div class="info-box concept">
                    <h4>Q1: What's the difference between ENTRYPOINT and CMD?</h4>
                    <p><strong>A:</strong> ENTRYPOINT defines the main executable that always runs. CMD provides default arguments that can be overridden at runtime. Together, they provide flexibility with safety - you ensure the correct program runs while allowing configuration changes.</p>
                    <p><strong>Example:</strong> With <code>ENTRYPOINT ["curl"]</code> and <code>CMD ["https://example.com"]</code>, running <code>docker run myimage</code> executes <code>curl https://example.com</code>, but <code>docker run myimage https://google.com</code> executes <code>curl https://google.com</code>.</p>
                </div>

                <div class="info-box concept">
                    <h4>Q2: Why use multi-stage builds?</h4>
                    <p><strong>A:</strong> Multi-stage builds reduce the final image size and attack surface by separating build-time dependencies from runtime dependencies. Build tools stay in the build stage, only runtime artifacts go to production. This results in images that are ~97% smaller (25MB vs 800MB), more secure, and faster to deploy.</p>
                    <p><strong>Key Benefits:</strong></p>
                    <ul>
                        <li>Smaller images (faster deployments)</li>
                        <li>Better security (no build tools in production)</li>
                        <li>Cleaner images (only runtime dependencies)</li>
                        <li>Faster CI/CD pipelines</li>
                    </ul>
                </div>

                <div class="info-box concept">
                    <h4>Q3: Is running Nginx as root insecure?</h4>
                    <p><strong>A:</strong> The master process runs as root only to bind privileged port 80, but all request-handling workers run as the unprivileged nginx user. This means 99.99% of traffic is handled by non-root processes, limiting the blast radius of any exploit. For maximum security, you can configure Nginx to use port 8080 and run everything as non-root.</p>
                    <p><strong>Process Breakdown:</strong></p>
                    <ul>
                        <li><strong>Master (root):</strong> Binds port, reads config, spawns workers (1 process)</li>
                        <li><strong>Workers (nginx):</strong> Handle all HTTP requests (multiple processes)</li>
                    </ul>
                </div>

                <div class="info-box concept">
                    <h4>Q4: How does Nginx reverse proxy work?</h4>
                    <p><strong>A:</strong> Nginx sits between the client and backend servers. When a request comes in, Nginx examines the URL path and forwards it to the appropriate backend server based on location blocks. For example, requests to <code>/api/*</code> go to the API server while <code>/</code> serves static files. The client only knows one endpoint, eliminating CORS issues. Nginx also handles SSL termination, load balancing, and caching.</p>
                    <p><strong>Key Advantages:</strong></p>
                    <ul>
                        <li>Single origin (no CORS)</li>
                        <li>Backend IP hidden</li>
                        <li>SSL at one point</li>
                        <li>Load balancing</li>
                        <li>Caching layer</li>
                    </ul>
                </div>

                <div class="info-box concept">
                    <h4>Q5: How do you handle secrets in Docker?</h4>
                    <p><strong>A:</strong> Never hardcode secrets in Dockerfile or ENV directives. Instead, inject secrets at runtime using:</p>
                    <ol>
                        <li><strong>Environment variables:</strong> <code>docker run -e DB_PASSWORD=secret</code></li>
                        <li><strong>Docker secrets (Swarm):</strong> <code>docker secret create db_password -</code></li>
                        <li><strong>Kubernetes secrets:</strong> <code>kubectl create secret generic app-secrets</code></li>
                        <li><strong>External services:</strong> HashiCorp Vault, AWS Secrets Manager</li>
                    </ol>
                    <p><strong>Key principle:</strong> Image = Blueprint, Secrets = Keys (attached at runtime)</p>
                </div>

                <div class="info-box concept">
                    <h4>Q6: What's the purpose of .dockerignore?</h4>
                    <p><strong>A:</strong> .dockerignore prevents sensitive files and unnecessary data from being copied into the Docker image during build. Without it, secrets in .env files, node_modules, git history, and logs could leak into your image layers. This improves security and reduces image size.</p>
                </div>
            </div>

            <!-- Final Recommendations -->
            <div class="glass-card">
                <h2 class="section-title">‚ú® Final Recommendations</h2>

                <div class="info-box tip">
                    <strong>‚úÖ Always Do:</strong>
                    <ul>
                        <li>Use multi-stage builds for production</li>
                        <li>Include .dockerignore file</li>
                        <li>Inject secrets at runtime, never hardcode</li>
                        <li>Use specific version tags, not :latest</li>
                        <li>Scan images for vulnerabilities regularly</li>
                        <li>Run workers as non-root users</li>
                        <li>Use nginx for reverse proxy in production</li>
                        <li>Keep base images minimal (Alpine, Distroless)</li>
                        <li>Layer caching optimization (deps before source)</li>
                    </ul>
                </div>

                <div class="info-box danger">
                    <strong>‚ùå Never Do:</strong>
                    <ul>
                        <li>Include secrets in Dockerfile or image layers</li>
                        <li>Use :latest tag in production environments</li>
                        <li>Run applications as root unnecessarily</li>
                        <li>Skip .dockerignore file</li>
                        <li>Expose build tools in production images</li>
                        <li>Hardcode environment-specific configs</li>
                        <li>Copy entire project directory without filtering</li>
                        <li>Use shell form for ENTRYPOINT/CMD</li>
                    </ul>
                </div>

                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; border-radius: 16px; margin: 40px 0; text-align: center;">
                    <div style="font-size: 3rem; margin-bottom: 20px;">üéì</div>
                    <h3 style="font-size: 1.8rem; font-weight: 800; margin-bottom: 15px;">You're Production Ready!</h3>
                    <p style="font-size: 1.1rem; opacity: 0.95; line-height: 1.6;">
                        You now have complete knowledge of Docker production best practices.
                        From ENTRYPOINT/CMD to multi-stage builds, security, and nginx proxy configuration.
                    </p>
                    <p style="font-size: 1rem; margin-top: 20px; opacity: 0.9;">
                        ‚úÖ Multi-stage builds | ‚úÖ Security hardening | ‚úÖ Non-root users<br>
                        ‚úÖ Reverse proxy | ‚úÖ Production deployment | ‚úÖ Interview ready
                    </p>
                </div>
            </div>
        </div>

        <!-- Author Section -->
        <div class="author-section">
            <div class="author-icon">üë®‚Äçüíº</div>
            <h2 class="author-title">Created By</h2>
            <h3 class="author-name">Ritesh Sharma</h3>
            <p class="author-desc">
                DevOps Engineer | Cloud Architect
            </p>
            <p style="font-size: 0.9rem; color: rgba(255, 255, 255, 0.85); font-weight: 500; margin-bottom: 0;">
                Azure ‚Ä¢ Terraform ‚Ä¢ CI/CD ‚Ä¢ Kubernetes ‚Ä¢ Cloud Automation
            </p>

            <div class="social-links">
                <a href="https://www.linkedin.com/in/riteshatri" target="_blank" rel="noopener noreferrer" class="social-btn linkedin">
                    <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                    </svg>
                    LinkedIn
                </a>

                <a href="https://github.com/Riteshatri" target="_blank" rel="noopener noreferrer" class="social-btn github">
                    <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                    GitHub
                </a>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>üê≥ Docker Production Best Practices | Complete Guide 2024</p>
    </div>

    <script>
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.add('hidden'));

            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => btn.classList.remove('active'));

            document.getElementById(sectionId).classList.remove('hidden');
            event.target.classList.add('active');

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>